version: "3.9"

services:
  n8n:
    image: docker.n8n.io/n8nio/n8n:latest
    container_name: n8n
    ports:
      - "5678:5678"
    environment:
      N8N_SECURE_COOKIE: "false"
      N8N_RUNNERS_ENABLED: "true"
    volumes:
      - n8n_data:/home/node/.n8n
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: always
    networks:
      - automation

  appium:
    image: appium/appium:latest
    container_name: appium
    privileged: true
    ports:
      - "4723:4723"
    environment:
      APPIUM_ALLOW_INSECURE: "relaxed_security"
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: always
    networks:
      - automation

  frpc:
    image: fatedier/frpc:latest
    container_name: frpc
    volumes:
      - ./frpc.toml:/etc/frp/frpc.toml:ro
    command: ["-c", "/etc/frp/frpc.toml"]
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: always
    networks:
      - automation

networks:
  automation:
    driver: bridge

volumes:
  n8n_data: